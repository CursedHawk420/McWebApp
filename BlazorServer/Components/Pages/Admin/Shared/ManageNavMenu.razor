@using Microsoft.AspNetCore.Identity
@inherits LanguageBase
@inject IUserService _userService
@inject IRefreshService _refreshService

@implements IAsyncDisposable

<ul class="nav nav-pills flex-column">
    <li class="nav-item">
        <NavLink class="nav-link" href="Admin/Manage/Users">@l["nav-admin-users"]</NavLink>
    </li>
    <li class="nav-item">
        <NavLink class="nav-link" href="Admin/Manage/ActiveSessions">@l["nav-admin-ActiveSessions"]</NavLink>
    </li>
    <li class="nav-item">
        <NavLink class="nav-link" href="Admin/Manage/Language">@l["nav-admin-LanguageEditor"]</NavLink>
    </li>
</ul>


@code {
    //TODO Dispose

    protected override async Task OnInitializedAsync()
    {
        _refreshService.PageRefreshRequested += Refresh;

        Refresh();
    }

    public async void Refresh()
    {
        StateHasChanged();
    }


    private async void RefreshAsync()
    {
        // InvokeAsync is inherited, it syncs the call back to the render thread
        await InvokeAsync(() =>
        {
            StateHasChanged();
        });
    }

    public async ValueTask DisposeAsync()
    {
        _refreshService.PageRefreshRequested -= Refresh;
    }
}
